<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>onCompletion</title>
</head><body><link href="../../../images/logo-icon.svg" rel="icon" type="image/svg"><script>var pathToRoot = "../../";</script><script type="text/javascript" src="../../scripts/sourceset_dependencies.js" async></script><link href="../../styles/style.css" rel="Stylesheet"><link href="../../styles/logo-styles.css" rel="Stylesheet"><link href="../../styles/jetbrains-mono.css" rel="Stylesheet"><link href="../../styles/main.css" rel="Stylesheet"><script type="text/javascript" src="../../scripts/clipboard.js" async></script><script type="text/javascript" src="../../scripts/navigation-loader.js" async></script><script type="text/javascript" src="../../scripts/platform-content-handler.js" async></script><script type="text/javascript" src="../../scripts/main.js" async></script>
  
    <div id="container">
      <div id="leftColumn"><a href="../../index.html">
            <div id="logo"></div>
          </a>
        <div id="paneSearch"></div>
        <div id="sideMenu"></div>
      </div>
      <div id="main">
        <script type="text/javascript" src="../../scripts/main.js"></script><div id="leftToggler"><span class="icon-toggler"></span></div>

        <div class="main-content" id="content" pageids="kotlinx-coroutines-core::kotlinx.coroutines.flow//onCompletion/kotlinx.coroutines.flow.Flow[TypeParam(bounds=[kotlin.Any?])]#kotlin.coroutines.SuspendFunction2[kotlinx.coroutines.flow.FlowCollector[TypeParam(bounds=[kotlin.Any?])],kotlin.Throwable?,kotlin.Unit]/PointingToDeclaration//1975948010">
          <div class="navigation-wrapper" id="navigation-wrapper">
            <div class="breadcrumbs"><a href="../index.html">kotlinx-coroutines-core</a>/<a href="index.html">kotlinx.coroutines.flow</a>/<a href="on-completion.html">onCompletion</a></div>
            <div class="pull-right d-flex">
              <div class="filter-section" id="filter-section"><button class="platform-tag platform-selector common-like" data-active="" data-filter=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain">common</button></div>
              <div id="searchBar"></div>
            </div>
          </div>
          <div class="cover ">
            <h1 class="cover"><span>on</span><wbr><span>Completion</span></h1>
          </div>
<div class="divergent-group" data-filterable-current=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain" data-filterable-set=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain"><div class="with-platform-tags"><span class="pull-right"></span></div>

  <div>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-depenent-content" data-active="" data-togglable=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain"><div class="symbol monospace">fun &lt;<a href="on-completion.html">T</a>&gt; <a href="-flow/index.html">Flow</a>&lt;<a href="on-completion.html">T</a>&gt;.<a href="on-completion.html">onCompletion</a>(action: suspend <a href="-flow-collector/index.html">FlowCollector</a>&lt;<a href="on-completion.html">T</a>&gt;.(cause: <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html">Throwable</a>?) -&gt; <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html">Unit</a>): <a href="-flow/index.html">Flow</a>&lt;<a href="on-completion.html">T</a>&gt;<span class="top-right-position"><span class="copy-icon"></span><div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div></span></div></div></div>
  </div>
<p class="paragraph">Returns a flow that invokes the given <a href="on-completion.html">action</a>after the flow is completed or cancelled, passing the cancellation exception or failure as cause parameter of <a href="on-completion.html">action</a>.</p><p class="paragraph">Conceptually, <code>onCompletion</code> is similar to wrapping the flow collection into a <code>finally</code> block, for example the following imperative snippet:</p><div class="sample-container"><code class="" theme="idea"><pre>try {<br>    myFlow.collect { value -&gt;<br>        println(value)<br>    }<br>} finally {<br>    println("Done")<br>}</pre></code></div><p class="paragraph">can be replaced with a declarative one using <code>onCompletion</code>:</p><div class="sample-container"><code class="" theme="idea"><pre>myFlow<br>    .onEach { println(it) }<br>    .onCompletion { println("Done") }<br>    .collect()</pre></code></div><p class="paragraph">Unlike <a href="catch.html">catch</a>, this operator reports exception that occur both upstream and downstream and observe exceptions that are thrown to cancel the flow. Exception is empty if and only if the flow had fully completed successfully. Conceptually, the following code:</p><div class="sample-container"><code class="" theme="idea"><pre>myFlow.collect { value -&gt;<br>    println(value)<br>}<br>println("Completed successfully")</pre></code></div><p class="paragraph">can be replaced with:</p><div class="sample-container"><code class="" theme="idea"><pre>myFlow<br>    .onEach { println(it) }<br>    .onCompletion { if (it == null) println("Completed successfully") }<br>    .collect()</pre></code></div><p class="paragraph">The receiver of the <a href="on-completion.html">action</a> is <a href="-flow-collector/index.html">FlowCollector</a> and this operator can be used to emit additional elements at the end if it completed successfully. For example:</p><div class="sample-container"><code class="" theme="idea"><pre>flowOf("a", "b", "c")<br>    .onCompletion { emit("Done") }<br>    .collect { println(it) } // prints a, b, c, Done</pre></code></div><p class="paragraph">In case of failure or cancellation, any attempt to emit additional elements throws the corresponding exception. Use <a href="catch.html">catch</a> if you need to suppress failure and replace it with emission of elements.</p></div>
          <h2 class="">Sources</h2>
          <div class="table" data-togglable="Sources"><a data-name="-349587874%2FSource%2F1975948010" anchor-label="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/flow/operators/Emitters.kt#L86" id="-349587874%2FSource%2F1975948010" data-filterable-set=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain"></a>
            <div class="table-row" data-filterable-current=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain" data-filterable-set=":kotlinx-coroutines-core:dokkaHtmlPartial/commonMain">
              <div class="main-subrow keyValue ">
                <div class=""><span class="inline-flex"><a href="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/flow/operators/Emitters.kt#L86">common source</a><span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-349587874%2FSource%2F1975948010"></span>
                      <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                    </span></span></div>
                <div></div>
              </div>
            </div>
          </div>
        </div>
        <div class="footer"><span class="go-to-top-icon"><a href="#content"></a></span><span>Â© 2021 Copyright</span><span class="pull-right"><span>Generated by </span><a href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span></div>
      </div>
    </div>
  
</body></html>


