<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CoroutineExceptionHandler - kotlinx-coroutines-core</title>
  <meta name="description" content="Library support for kotlin coroutines">
  <link rel="stylesheet" href="/kotlinx.coroutines/assets/main.css">
  <link rel="canonical" href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-exception-handler/">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/kotlinx.coroutines/assets/js/api.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-47631155-3', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body>
    <header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/kotlinx.coroutines/">kotlinx.coroutines</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="api-docs-breadcrumbs"><a href="../../index.html">kotlinx-coroutines-core</a> / <a href="../index.html">kotlinx.coroutines</a> / <a href="./index.html">CoroutineExceptionHandler</a></div>

<h1 id="coroutineexceptionhandler">CoroutineExceptionHandler</h1>

<div class="signature"><code><span class="keyword">interface </span><span class="identifier">CoroutineExceptionHandler</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/-element/index.html"><span class="identifier">Element</span></a></code> <a href="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/CoroutineExceptionHandler.kt#L98">(source)</a></div>

<p>An optional element in the coroutine context to handle <strong>uncaught</strong> exceptions.</p>

<p>Normally, uncaught exceptions can only result from <em>root</em> coroutines created using the <a href="../launch.html">launch</a> builder.
All <em>children</em> coroutines (coroutines created in the context of another <a href="../-job/index.html">Job</a>) delegate handling of their
exceptions to their parent coroutine, which also delegates to the parent, and so on until the root,
so the <code>CoroutineExceptionHandler</code> installed in their context is never used.
Coroutines running with <a href="../-supervisor-job.html">SupervisorJob</a> do not propagate exceptions to their parent and are treated like root coroutines.
A coroutine that was created using <a href="../async.html">async</a> always catches all its exceptions and represents them
in the resulting <a href="../-deferred/index.html">Deferred</a> object, so it cannot result in uncaught exceptions.</p>

<h3 id="handling-coroutine-exceptions">Handling coroutine exceptions</h3>

<p><code>CoroutineExceptionHandler</code> is a last-resort mechanism for global “catch all” behavior.
You cannot recover from the exception in the <code>CoroutineExceptionHandler</code>. The coroutine had already completed
with the corresponding exception when the handler is called. Normally, the handler is used to
log the exception, show some kind of error message, terminate, and/or restart the application.</p>

<p>If you need to handle exception in a specific part of the code, it is recommended to use <code>try</code>/<code>catch</code> around
the corresponding code inside your coroutine. This way you can prevent completion of the coroutine
with the exception (exception is now <em>caught</em>), retry the operation, and/or take other arbitrary actions:</p>

<pre>scope.launch { // launch child coroutine in a scope
    try {
         // do something
    } catch (e: Throwable) {
         // handle exception
    }
}
</pre>

<h3 id="implementation-details">Implementation details</h3>

<p>By default, when no handler is installed, uncaught exception are handled in the following way:</p>

<ul>
  <li>If exception is <a href="../-cancellation-exception/index.html">CancellationException</a> then it is ignored
(because that is the supposed mechanism to cancel the running coroutine)</li>
  <li>Otherwise:
    <ul>
      <li>if there is a <a href="../-job/index.html">Job</a> in the context, then <a href="../-job/cancel.html">Job.cancel</a> is invoked;</li>
      <li>Otherwise, all instances of <a href="./index.html">CoroutineExceptionHandler</a> found via <a href="#">ServiceLoader</a></li>
      <li>and current thread’s <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#uncaughtExceptionHandler">Thread.uncaughtExceptionHandler</a> are invoked.</li>
    </ul>
  </li>
</ul>

<p><a href="./index.html">CoroutineExceptionHandler</a> can be invoked from an arbitrary thread.</p>

<h3 id="types">Types</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="-key.html">Key</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">companion</span> <span class="keyword">object </span><span class="identifier">Key</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/-key/index.html"><span class="identifier">Key</span></a><span class="symbol">&lt;</span><a href="./index.html"><span class="identifier">CoroutineExceptionHandler</span></a><span class="symbol">&gt;</span></code></div>

        <p>Key for <a href="./index.html">CoroutineExceptionHandler</a> instance in the coroutine context.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="functions">Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="handle-exception.html">handleException</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">handleException</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CoroutineExceptionHandler$handleException(kotlin.coroutines.CoroutineContext, kotlin.Throwable)/context">context</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">, </span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CoroutineExceptionHandler$handleException(kotlin.coroutines.CoroutineContext, kotlin.Throwable)/exception">exception</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Handles uncaught <a href="handle-exception.html#kotlinx.coroutines.CoroutineExceptionHandler$handleException(kotlin.coroutines.CoroutineContext, kotlin.Throwable)/exception">exception</a> in the given <a href="handle-exception.html#kotlinx.coroutines.CoroutineExceptionHandler$handleException(kotlin.coroutines.CoroutineContext, kotlin.Throwable)/context">context</a>. It is invoked
if coroutine has an uncaught exception.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="extension-properties">Extension Properties</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="../kotlin.coroutines.-coroutine-context/is-active.html">isActive</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">.</span><span class="identifier">isActive</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Returns <code>true</code> when the <a href="../-job/index.html">Job</a> of the coroutine in this context is still active
(has not completed and was not cancelled yet).</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="../kotlin.coroutines.-coroutine-context/job.html">job</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">.</span><span class="identifier">job</span><span class="symbol">: </span><a href="../-job/index.html"><span class="identifier">Job</span></a></code></div>

        <p>Retrieves the current <a href="../-job/index.html">Job</a> instance from the given <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html">CoroutineContext</a> or
throws <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a> if no job is present in the context.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="extension-functions">Extension Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="../kotlin.coroutines.-coroutine-context/cancel.html">cancel</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">.</span><span class="identifier">cancel</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines$cancel(kotlin.coroutines.CoroutineContext, kotlinx.coroutines.CancellationException)/cause">cause</span><span class="symbol">:</span>&nbsp;<a href="../-cancellation-exception/index.html"><span class="identifier">CancellationException</span></a><span class="symbol">?</span>&nbsp;<span class="symbol">=</span>&nbsp;null<br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Cancels <a href="../-job/index.html">Job</a> of this context with an optional cancellation cause.
See <a href="../-job/cancel.html">Job.cancel</a> for details.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="../kotlin.coroutines.-coroutine-context/cancel-children.html">cancelChildren</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">.</span><span class="identifier">cancelChildren</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines$cancelChildren(kotlin.coroutines.CoroutineContext, kotlinx.coroutines.CancellationException)/cause">cause</span><span class="symbol">:</span>&nbsp;<a href="../-cancellation-exception/index.html"><span class="identifier">CancellationException</span></a><span class="symbol">?</span>&nbsp;<span class="symbol">=</span>&nbsp;null<br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Cancels all children of the <a href="../-job/index.html">Job</a> in this context, without touching the state of this job itself
with an optional cancellation cause. See <a href="../-job/cancel.html">Job.cancel</a>.
It does not do anything if there is no job in the context or it has no children.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="../kotlin.coroutines.-coroutine-context/ensure-active.html">ensureActive</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html"><span class="identifier">CoroutineContext</span></a><span class="symbol">.</span><span class="identifier">ensureActive</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Ensures that job in the current context is <a href="../-job/is-active.html">active</a>.</p>

      </td>
</tr>
</tbody>
</table>

      </div>
    </main>
    <footer class="site-footer">
  <!-- empty -->
</footer>

  </body>
</html>

