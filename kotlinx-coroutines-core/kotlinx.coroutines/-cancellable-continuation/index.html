<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CancellableContinuation - kotlinx-coroutines-core</title>
  <meta name="description" content="Library support for kotlin coroutines">
  <link rel="stylesheet" href="/kotlinx.coroutines/assets/main.css">
  <link rel="canonical" href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-cancellable-continuation/">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/kotlinx.coroutines/assets/js/api.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-47631155-3', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body>
    <header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/kotlinx.coroutines/">kotlinx.coroutines</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="api-docs-breadcrumbs"><a href="../../index.html">kotlinx-coroutines-core</a> / <a href="../index.html">kotlinx.coroutines</a> / <a href="./index.html">CancellableContinuation</a></div>

<h1 id="cancellablecontinuation">CancellableContinuation</h1>

<div class="signature"><code><span class="keyword">interface </span><span class="identifier">CancellableContinuation</span><span class="symbol">&lt;</span><span class="keyword">in</span>&nbsp;<span class="identifier">T</span><span class="symbol">&gt;</span>&nbsp;<span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-continuation/index.html"><span class="identifier">Continuation</span></a><span class="symbol">&lt;</span><a href="index.html#T"><span class="identifier">T</span></a><span class="symbol">&gt;</span></code> <a href="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/CancellableContinuation.kt#L48">(source)</a></div>

<p>Cancellable continuation. It is <em>completed</em> when resumed or cancelled.
When the <a href="cancel.html">cancel</a> function is explicitly invoked, this continuation immediately resumes with a <a href="../-cancellation-exception/index.html">CancellationException</a> or
the specified cancel cause.</p>

<p>An instance of <code>CancellableContinuation</code> is created by the <a href="../suspend-cancellable-coroutine.html">suspendCancellableCoroutine</a> function.</p>

<p>Cancellable continuation has three states (as subset of <a href="../-job/index.html">Job</a> states):</p>

<table>
  <thead>
    <tr>
      <th><strong>State</strong></th>
      <th><a href="is-active.html">isActive</a></th>
      <th><a href="is-completed.html">isCompleted</a></th>
      <th><a href="is-cancelled.html">isCancelled</a></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>Active</em> (initial state)</td>
      <td><code>true</code></td>
      <td><code>false</code></td>
      <td><code>false</code></td>
    </tr>
    <tr>
      <td><em>Resumed</em> (final <em>completed</em> state)</td>
      <td><code>false</code></td>
      <td><code>true</code></td>
      <td><code>false</code></td>
    </tr>
    <tr>
      <td><em>Canceled</em> (final <em>completed</em> state)</td>
      <td><code>false</code></td>
      <td><code>true</code></td>
      <td><code>true</code></td>
    </tr>
  </tbody>
</table>

<p>Invocation of <a href="cancel.html">cancel</a> transitions this continuation from <em>active</em> to <em>cancelled</em> state, while
invocation of <a href="#">Continuation.resume</a> or <a href="#">Continuation.resumeWithException</a> transitions it from <em>active</em> to <em>resumed</em> state.</p>

<p>A <a href="is-cancelled.html">cancelled</a> continuation implies that it is <a href="is-completed.html">completed</a>.</p>

<p>Invocation of <a href="#">Continuation.resume</a> or <a href="#">Continuation.resumeWithException</a> in <em>resumed</em> state produces an <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a>,
but is ignored in <em>cancelled</em> state.</p>

<pre>    +-----------+   resume    +---------+
    |  Active   | ----------&gt; | Resumed |
    +-----------+             +---------+
          |
          | cancel
          V
    +-----------+
    | Cancelled |
    +-----------+
</pre>

<h3 id="properties">Properties</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="is-active.html">isActive</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">isActive</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Returns <code>true</code> when this continuation is active â€“ it has not completed or cancelled yet.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="is-cancelled.html">isCancelled</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">isCancelled</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Returns <code>true</code> if this continuation was <a href="cancel.html">cancelled</a>.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="is-completed.html">isCompleted</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">val </span><span class="identifier">isCompleted</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Returns <code>true</code> when this continuation has completed for any reason. A cancelled continuation
is also considered complete.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="functions">Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="cancel.html">cancel</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">cancel</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$cancel(kotlin.Throwable)/cause">cause</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><span class="symbol">?</span>&nbsp;<span class="symbol">=</span>&nbsp;null<span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Cancels this continuation with an optional cancellation <code>cause</code>. The result is <code>true</code> if this continuation was
cancelled as a result of this invocation, and <code>false</code> otherwise.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="invoke-on-cancellation.html">invokeOnCancellation</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">invokeOnCancellation</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$invokeOnCancellation(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</span><span class="symbol">:</span>&nbsp;<a href="../-completion-handler.html"><span class="identifier">CompletionHandler</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Registers a <a href="invoke-on-cancellation.html#kotlinx.coroutines.CancellableContinuation$invokeOnCancellation(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</a> to be <strong>synchronously</strong> invoked on <a href="cancel.html">cancellation</a> (regular or exceptional) of this continuation.
When the continuation is already cancelled, the handler is immediately invoked
with the cancellation exception. Otherwise, the handler will be invoked as soon as this
continuation is cancelled.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="resume.html">resume</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">resume</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$resume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/value">value</span><span class="symbol">:</span>&nbsp;<a href="index.html#T"><span class="identifier">T</span></a><span class="symbol">, </span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$resume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/onCancellation">onCancellation</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><span class="parameterName">cause</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Resumes this continuation with the specified <code>value</code> and calls the specified <code>onCancellation</code>
handler when either resumed too late (when continuation was already cancelled) or, although resumed
successfully (before cancellation), the coroutineâ€™s job was cancelled before it had a
chance to run in its dispatcher, so that the suspended function threw an exception
instead of returning this value.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="resume-undispatched.html">resumeUndispatched</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><a href="../-coroutine-dispatcher/index.html"><span class="identifier">CoroutineDispatcher</span></a><span class="symbol">.</span><span class="identifier">resumeUndispatched</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$resumeUndispatched(kotlinx.coroutines.CoroutineDispatcher, kotlinx.coroutines.CancellableContinuation.T)/value">value</span><span class="symbol">:</span>&nbsp;<a href="index.html#T"><span class="identifier">T</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Resumes this continuation with the specified <a href="resume-undispatched.html#kotlinx.coroutines.CancellableContinuation$resumeUndispatched(kotlinx.coroutines.CoroutineDispatcher, kotlinx.coroutines.CancellableContinuation.T)/value">value</a> in the invoker thread without going through
the <a href="../-coroutine-dispatcher/dispatch.html">dispatch</a> function of the <a href="../-coroutine-dispatcher/index.html">CoroutineDispatcher</a> in the <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-continuation/context.html">context</a>.
This function is designed to only be used by <a href="../-coroutine-dispatcher/index.html">CoroutineDispatcher</a> implementations.
<strong>It should not be used in general code</strong>.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="resume-undispatched-with-exception.html">resumeUndispatchedWithException</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><a href="../-coroutine-dispatcher/index.html"><span class="identifier">CoroutineDispatcher</span></a><span class="symbol">.</span><span class="identifier">resumeUndispatchedWithException</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$resumeUndispatchedWithException(kotlinx.coroutines.CoroutineDispatcher, kotlin.Throwable)/exception">exception</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Resumes this continuation with the specified <a href="resume-undispatched-with-exception.html#kotlinx.coroutines.CancellableContinuation$resumeUndispatchedWithException(kotlinx.coroutines.CoroutineDispatcher, kotlin.Throwable)/exception">exception</a> in the invoker thread without going through
the <a href="../-coroutine-dispatcher/dispatch.html">dispatch</a> function of the <a href="../-coroutine-dispatcher/index.html">CoroutineDispatcher</a> in the <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-continuation/context.html">context</a>.
This function is designed to only be used by <a href="../-coroutine-dispatcher/index.html">CoroutineDispatcher</a> implementations.
<strong>It should not be used in general code</strong>.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="try-resume.html">tryResume</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">tryResume</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$tryResume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Any, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/value">value</span><span class="symbol">:</span>&nbsp;<a href="index.html#T"><span class="identifier">T</span></a><span class="symbol">, </span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$tryResume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Any, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/idempotent">idempotent</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">?</span><span class="symbol">, </span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.CancellableContinuation$tryResume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Any, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/onCancellation">onCancellation</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><span class="parameterName">cause</span><span class="symbol">:</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html"><span class="identifier">Throwable</span></a><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html"><span class="identifier">Any</span></a><span class="symbol">?</span></code></div>

        <p>Same as <a href="#">tryResume</a> but with <a href="try-resume.html#kotlinx.coroutines.CancellableContinuation$tryResume(kotlinx.coroutines.CancellableContinuation.T, kotlin.Any, kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/onCancellation">onCancellation</a> handler that called if and only if the value is not
delivered to the caller because of the dispatch in the process, so that atomicity delivery
guaranteed can be provided by having a cancellation fallback.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="extension-functions">Extension Functions</h3>

<table class="api-docs-table">
<tbody>
<tr data-platform="JVM"><td>

        <p><a href="../cancel-future-on-cancellation.html">cancelFutureOnCancellation</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><a href="./index.html"><span class="identifier">CancellableContinuation</span></a><span class="symbol">&lt;</span><span class="identifier">*</span><span class="symbol">&gt;</span><span class="symbol">.</span><span class="identifier">cancelFutureOnCancellation</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines$cancelFutureOnCancellation(kotlinx.coroutines.CancellableContinuation((kotlin.Any)), java.util.concurrent.Future((kotlin.Any)))/future">future</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Future.html"><span class="identifier">Future</span></a><span class="symbol">&lt;</span><span class="identifier">*</span><span class="symbol">&gt;</span><br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Cancels a specified <a href="../cancel-future-on-cancellation.html#kotlinx.coroutines$cancelFutureOnCancellation(kotlinx.coroutines.CancellableContinuation((kotlin.Any)), java.util.concurrent.Future((kotlin.Any)))/future">future</a> when this job is cancelled.
This is a shortcut for the following code with slightly more efficient implementation (one fewer object created).</p>

      </td>
</tr></tbody>
</table>

      </div>
    </main>
    <footer class="site-footer">
  <!-- empty -->
</footer>

  </body>
</html>

