<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Job.invokeOnCompletion - kotlinx-coroutines-core</title>
  <meta name="description" content="Library support for kotlin coroutines">
  <link rel="stylesheet" href="/kotlinx.coroutines/assets/main.css">
  <link rel="canonical" href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-job/invoke-on-completion.html">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/kotlinx.coroutines/assets/js/api.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-47631155-3', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body>
    <header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/kotlinx.coroutines/">kotlinx.coroutines</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="api-docs-breadcrumbs"><a href="../../index.html">kotlinx-coroutines-core</a> / <a href="../index.html">kotlinx.coroutines</a> / <a href="index.html">Job</a> / <a href="./invoke-on-completion.html">invokeOnCompletion</a></div>

<h1 id="invokeoncompletion">invokeOnCompletion</h1>

<div class="signature"><code><span class="keyword">abstract</span> <span class="keyword">fun </span><span class="identifier">invokeOnCompletion</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.Job$invokeOnCompletion(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</span><span class="symbol">:</span>&nbsp;<a href="../-completion-handler.html"><span class="identifier">CompletionHandler</span></a><br /><span class="symbol">)</span><span class="symbol">: </span><a href="../-disposable-handle/index.html"><span class="identifier">DisposableHandle</span></a></code> <a href="https://github.com/kotlin/kotlinx.coroutines/tree/master/kotlinx-coroutines-core/common/src/Job.kt#L278">(source)</a></div>

<p>Registers handler that is <strong>synchronously</strong> invoked once on completion of this job.
When job is already complete, then the handler is immediately invoked
with a jobâ€™s exception or cancellation cause or <code>null</code>. Otherwise, handler will be invoked once when this
job is complete.</p>

<p>The meaning of <code>cause</code> that is passed to the handler:</p>

<ul>
  <li>Cause is <code>null</code> when job has completed normally.</li>
  <li>Cause is an instance of <a href="../-cancellation-exception/index.html">CancellationException</a> when job was cancelled <em>normally</em>.
<strong>It should not be treated as an error</strong>. In particular, it should not be reported to error logs.</li>
  <li>Otherwise, the job had <em>failed</em>.</li>
</ul>

<p>The resulting <a href="../-disposable-handle/index.html">DisposableHandle</a> can be used to <a href="../-disposable-handle/dispose.html">dispose</a> the
registration of this handler and release its memory if its invocation is no longer needed.
There is no need to dispose the handler after completion of this job. The references to
all the handlers are released when this job completes.</p>

<p>Installed <a href="invoke-on-completion.html#kotlinx.coroutines.Job$invokeOnCompletion(kotlin.Function1((kotlin.Throwable, kotlin.Unit)))/handler">handler</a> should not throw any exceptions. If it does, they will get caught,
wrapped into <a href="#">CompletionHandlerException</a>, and rethrown, potentially causing crash of unrelated code.</p>

<p><strong>Note</strong>: Implementations of <code>CompletionHandler</code> must be fast and <em>lock-free</em>.</p>


      </div>
    </main>
    <footer class="site-footer">
  <!-- empty -->
</footer>

  </body>
</html>

