<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DebugProbes - kotlinx-coroutines-debug</title>
  <meta name="description" content="Library support for kotlin coroutines">
  <link rel="stylesheet" href="/kotlinx.coroutines/assets/main.css">
  <link rel="canonical" href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-debug/kotlinx.coroutines.debug/-debug-probes/">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="/kotlinx.coroutines/assets/js/api.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-47631155-3', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body>
    <header class="site-header" role="banner">
  <div class="wrapper">
    <a class="site-title" href="/kotlinx.coroutines/">kotlinx.coroutines</a>
  </div>
</header>

    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="api-docs-breadcrumbs"><a href="../../index.html">kotlinx-coroutines-debug</a> / <a href="../index.html">kotlinx.coroutines.debug</a> / <a href="./index.html">DebugProbes</a></div>

<h1 id="debugprobes">DebugProbes</h1>

<div class="signature"><code><span class="identifier">@ExperimentalCoroutinesApi</span> <span class="keyword">object </span><span class="identifier">DebugProbes</span></code></div>

<p>Debug probes support.</p>

<p>Debug probes is a dynamic attach mechanism which installs multiple hooks into coroutines machinery.
It slows down all coroutine-related code, but in return provides a lot of diagnostic information, including
asynchronous stack-traces and coroutine dumps (similar to <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/management/ThreadMXBean.html#dumpAllThreads(boolean, boolean)">ThreadMXBean.dumpAllThreads</a> and <code>jstack</code> via <a href="dump-coroutines.html">DebugProbes.dumpCoroutines</a>.
All introspecting methods throw <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a> if debug probes were not installed.</p>

<p>Installed hooks:</p>

<ul>
  <li><code>probeCoroutineResumed</code> is invoked on every <a href="#">Continuation.resume</a>.</li>
  <li><code>probeCoroutineSuspended</code> is invoked on every continuation suspension.</li>
  <li><code>probeCoroutineCreated</code> is invoked on every coroutine creation using stdlib intrinsics.</li>
</ul>

<p>Overhead:</p>

<ul>
  <li>Every created coroutine is stored in a concurrent hash map and hash map is looked up and
  updated on each suspension and resumption.</li>
  <li>If <a href="enable-creation-stack-traces.html">DebugProbes.enableCreationStackTraces</a> is enabled, stack trace of the current thread is captured on
  each created coroutine that is a rough equivalent of throwing an exception per each created coroutine.</li>
</ul>

<h3 id="properties">Properties</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="enable-creation-stack-traces.html">enableCreationStackTraces</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">var </span><span class="identifier">enableCreationStackTraces</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Whether coroutine creation stack traces should be captured.
When enabled, for each created coroutine a stack trace of the current
thread is captured and attached to the coroutine.
This option can be useful during local debug sessions, but is recommended
to be disabled in production environments to avoid stack trace dumping overhead.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="is-installed.html">isInstalled</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">val </span><span class="identifier">isInstalled</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Determines whether debug probes were <a href="install.html">installed</a>.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="sanitize-stack-traces.html">sanitizeStackTraces</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">var </span><span class="identifier">sanitizeStackTraces</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html"><span class="identifier">Boolean</span></a></code></div>

        <p>Whether coroutine creation stack traces should be sanitized.
Sanitization removes all frames from <code>kotlinx.coroutines</code> package except
the first one and the last one to simplify diagnostic.</p>

      </td>
</tr>
</tbody>
</table>

<h3 id="functions">Functions</h3>

<table class="api-docs-table">
<tbody>
<tr>
<td>

        <p><a href="dump-coroutines.html">dumpCoroutines</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">dumpCoroutines</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$dumpCoroutines(java.io.PrintStream)/out">out</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html"><span class="identifier">PrintStream</span></a>&nbsp;<span class="symbol">=</span>&nbsp;System.out<span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Dumps all active coroutines into the given output stream, providing a consistent snapshot of all existing coroutines at the moment of invocation.
The output of this method is similar to <code>jstack</code> or a full thread dump. It can be used as the replacement to
“Dump threads” action.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="dump-coroutines-info.html">dumpCoroutinesInfo</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">dumpCoroutinesInfo</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/index.html"><span class="identifier">List</span></a><span class="symbol">&lt;</span><a href="../-coroutine-info/index.html"><span class="identifier">CoroutineInfo</span></a><span class="symbol">&gt;</span></code></div>

        <p>Returns all existing coroutines info.
The resulting collection represents a consistent snapshot of all existing coroutines at the moment of invocation.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="install.html">install</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">install</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Installs a <a href="./index.html">DebugProbes</a> instead of no-op stdlib probes by redefining
debug probes class using the same class loader as one loaded <a href="./index.html">DebugProbes</a> class.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="job-to-string.html">jobToString</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">jobToString</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$jobToString(kotlinx.coroutines.Job)/job">job</span><span class="symbol">:</span>&nbsp;<a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-job/index.html"><span class="identifier">Job</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a></code></div>

        <p>Returns string representation of the coroutines <a href="job-to-string.html#kotlinx.coroutines.debug.DebugProbes$jobToString(kotlinx.coroutines.Job)/job">job</a> hierarchy with additional debug information.
Hierarchy is printed from the <a href="job-to-string.html#kotlinx.coroutines.debug.DebugProbes$jobToString(kotlinx.coroutines.Job)/job">job</a> as a root transitively to all children.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="print-job.html">printJob</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">printJob</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$printJob(kotlinx.coroutines.Job, java.io.PrintStream)/job">job</span><span class="symbol">:</span>&nbsp;<a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-job/index.html"><span class="identifier">Job</span></a><span class="symbol">, </span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$printJob(kotlinx.coroutines.Job, java.io.PrintStream)/out">out</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html"><span class="identifier">PrintStream</span></a>&nbsp;<span class="symbol">=</span>&nbsp;System.out<span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Prints <a href="print-job.html#kotlinx.coroutines.debug.DebugProbes$printJob(kotlinx.coroutines.Job, java.io.PrintStream)/job">job</a> hierarchy representation from <a href="job-to-string.html">jobToString</a> to the given <a href="print-job.html#kotlinx.coroutines.debug.DebugProbes$printJob(kotlinx.coroutines.Job, java.io.PrintStream)/out">out</a>.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="print-scope.html">printScope</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">printScope</span><span class="symbol">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$printScope(kotlinx.coroutines.CoroutineScope, java.io.PrintStream)/scope">scope</span><span class="symbol">:</span>&nbsp;<a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-scope/index.html"><span class="identifier">CoroutineScope</span></a><span class="symbol">, </span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$printScope(kotlinx.coroutines.CoroutineScope, java.io.PrintStream)/out">out</span><span class="symbol">:</span>&nbsp;<a href="http://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html"><span class="identifier">PrintStream</span></a>&nbsp;<span class="symbol">=</span>&nbsp;System.out<br /><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Prints all coroutines launched within the given <a href="print-scope.html#kotlinx.coroutines.debug.DebugProbes$printScope(kotlinx.coroutines.CoroutineScope, java.io.PrintStream)/scope">scope</a>.
Throws <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a> if the scope has no a job in it.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="scope-to-string.html">scopeToString</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">scopeToString</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$scopeToString(kotlinx.coroutines.CoroutineScope)/scope">scope</span><span class="symbol">:</span>&nbsp;<a href="https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-scope/index.html"><span class="identifier">CoroutineScope</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html"><span class="identifier">String</span></a></code></div>

        <p>Returns string representation of all coroutines launched within the given <a href="scope-to-string.html#kotlinx.coroutines.debug.DebugProbes$scopeToString(kotlinx.coroutines.CoroutineScope)/scope">scope</a>.
Throws <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a> if the scope has no a job in it.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="uninstall.html">uninstall</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">uninstall</span><span class="symbol">(</span><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Uninstall debug probes.</p>

      </td>
</tr>
<tr>
<td>

        <p><a href="with-debug-probes.html">withDebugProbes</a></p>

      </td>
<td>
        <div class="signature"><code><span class="keyword">fun </span><span class="identifier">withDebugProbes</span><span class="symbol">(</span><span class="parameterName" id="kotlinx.coroutines.debug.DebugProbes$withDebugProbes(kotlin.Function0((kotlin.Unit)))/block">block</span><span class="symbol">:</span>&nbsp;<span class="symbol">(</span><span class="symbol">)</span>&nbsp;<span class="symbol">-&gt;</span>&nbsp;<a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a><span class="symbol">)</span><span class="symbol">: </span><a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html"><span class="identifier">Unit</span></a></code></div>

        <p>Invokes given block of code with installed debug probes and uninstall probes in the end.</p>

      </td>
</tr>
</tbody>
</table>

      </div>
    </main>
    <footer class="site-footer">
  <!-- empty -->
</footer>

  </body>
</html>

